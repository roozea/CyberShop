{"ast":null,"code":"import{Box,Button,FormControl,FormLabel,Input,VStack,Heading,Text,useToast}from'@chakra-ui/react';import{Link,useNavigate}from'react-router-dom';import{useState}from'react';import{login}from'../services/api';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export const Login=()=>{const toast=useToast();const navigate=useNavigate();const[formData,setFormData]=useState({email:'',password:''});const handleChange=e=>{const{name,value}=e.target;setFormData(prev=>({...prev,[name]:value}));};const handleLogin=async e=>{e.preventDefault();// Vulnerable: No validación de entrada\nconst response=await login(formData.email,formData.password);if(response&&response.access_token){// Vulnerable: Mensaje revela información\ntoast({title:'Inicio de sesión exitoso',description:`Bienvenido ${response.user_data.email}`,status:'success',duration:3000,isClosable:true});navigate('/');}else{// Vulnerable: Mensaje de error detallado\ntoast({title:'Error de autenticación',description:'Email o contraseña incorrectos',status:'error',duration:3000,isClosable:true});}};return/*#__PURE__*/_jsx(Box,{maxW:\"md\",mx:\"auto\",mt:8,children:/*#__PURE__*/_jsxs(VStack,{spacing:4,align:\"stretch\",as:\"form\",onSubmit:handleLogin,children:[/*#__PURE__*/_jsx(Heading,{children:\"Iniciar Sesi\\xF3n\"}),/*#__PURE__*/_jsxs(FormControl,{children:[/*#__PURE__*/_jsx(FormLabel,{children:\"Email\"}),/*#__PURE__*/_jsx(Input,{type:\"email\",name:\"email\",value:formData.email,onChange:handleChange,placeholder:\"tu@email.com\"})]}),/*#__PURE__*/_jsxs(FormControl,{children:[/*#__PURE__*/_jsx(FormLabel,{children:\"Contrase\\xF1a\"}),/*#__PURE__*/_jsx(Input,{type:\"password\",name:\"password\",value:formData.password,onChange:handleChange,placeholder:\"********\"})]}),/*#__PURE__*/_jsx(Button,{type:\"submit\",colorScheme:\"blue\",children:\"Ingresar\"}),/*#__PURE__*/_jsxs(Text,{children:[\"\\xBFNo tienes cuenta? \",/*#__PURE__*/_jsx(Link,{to:\"/register\",style:{color:'blue'},children:\"Reg\\xEDstrate aqu\\xED\"})]})]})});};","map":{"version":3,"names":["Box","Button","FormControl","FormLabel","Input","VStack","Heading","Text","useToast","Link","useNavigate","useState","login","jsx","_jsx","jsxs","_jsxs","Login","toast","navigate","formData","setFormData","email","password","handleChange","e","name","value","target","prev","handleLogin","preventDefault","response","access_token","title","description","user_data","status","duration","isClosable","maxW","mx","mt","children","spacing","align","as","onSubmit","type","onChange","placeholder","colorScheme","to","style","color"],"sources":["/home/ubuntu/cybershop-vuln-lab/CyberShop/frontend/src/pages/Login.js"],"sourcesContent":["import { Box, Button, FormControl, FormLabel, Input, VStack, Heading, Text, useToast } from '@chakra-ui/react';\nimport { Link, useNavigate } from 'react-router-dom';\nimport { useState } from 'react';\nimport { login } from '../services/api';\n\nexport const Login = () => {\n  const toast = useToast();\n  const navigate = useNavigate();\n  const [formData, setFormData] = useState({\n    email: '',\n    password: ''\n  });\n\n  const handleChange = (e) => {\n    const { name, value } = e.target;\n    setFormData(prev => ({\n      ...prev,\n      [name]: value\n    }));\n  };\n\n  const handleLogin = async (e) => {\n    e.preventDefault();\n\n    // Vulnerable: No validación de entrada\n    const response = await login(formData.email, formData.password);\n\n    if (response && response.access_token) {\n      // Vulnerable: Mensaje revela información\n      toast({\n        title: 'Inicio de sesión exitoso',\n        description: `Bienvenido ${response.user_data.email}`,\n        status: 'success',\n        duration: 3000,\n        isClosable: true,\n      });\n      navigate('/');\n    } else {\n      // Vulnerable: Mensaje de error detallado\n      toast({\n        title: 'Error de autenticación',\n        description: 'Email o contraseña incorrectos',\n        status: 'error',\n        duration: 3000,\n        isClosable: true,\n      });\n    }\n  };\n\n  return (\n    <Box maxW=\"md\" mx=\"auto\" mt={8}>\n      <VStack spacing={4} align=\"stretch\" as=\"form\" onSubmit={handleLogin}>\n        <Heading>Iniciar Sesión</Heading>\n        <FormControl>\n          <FormLabel>Email</FormLabel>\n          <Input\n            type=\"email\"\n            name=\"email\"\n            value={formData.email}\n            onChange={handleChange}\n            placeholder=\"tu@email.com\"\n          />\n        </FormControl>\n        <FormControl>\n          <FormLabel>Contraseña</FormLabel>\n          <Input\n            type=\"password\"\n            name=\"password\"\n            value={formData.password}\n            onChange={handleChange}\n            placeholder=\"********\"\n          />\n        </FormControl>\n        <Button type=\"submit\" colorScheme=\"blue\">Ingresar</Button>\n        <Text>\n          ¿No tienes cuenta? <Link to=\"/register\" style={{ color: 'blue' }}>Regístrate aquí</Link>\n        </Text>\n      </VStack>\n    </Box>\n  );\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}