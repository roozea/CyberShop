{"ast":null,"code":"import React,{useState}from'react';import{Box,VStack,Select,RangeSlider,RangeSliderTrack,RangeSliderFilledTrack,RangeSliderThumb,Text,Checkbox,Button,useToast}from'@chakra-ui/react';// Componente vulnerable que permite manipulación de parámetros de filtro\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export const ProductFilters=_ref=>{let{onFilter}=_ref;const[category,setCategory]=useState('all');const[priceRange,setPriceRange]=useState([0,2000]);const[inStock,setInStock]=useState(false);const toast=useToast();const categories=['all','laptops','smartphones','tablets','accessories'];// Vulnerable: No validación de entrada en los filtros\nconst applyFilters=()=>{// Vulnerable: Inyección de parámetros en la URL\nconst queryParams=new URLSearchParams(window.location.search);queryParams.set('category',category);queryParams.set('minPrice',priceRange[0]);queryParams.set('maxPrice',priceRange[1]);queryParams.set('inStock',inStock);// Vulnerable: Actualización directa de la URL sin sanitización\nwindow.history.pushState({},'',`${window.location.pathname}?${queryParams}`);// Vulnerable: Almacenamiento de preferencias sin encriptación\nlocalStorage.setItem('lastFilter',JSON.stringify({category,priceRange,inStock}));// Vulnerable: Ejecución directa de código desde localStorage\nconst savedCallback=localStorage.getItem('filterCallback');if(savedCallback){eval(savedCallback);}onFilter({category,priceRange,inStock});toast({title:\"Filtros aplicados\",status:\"success\",duration:2000,isClosable:true});};return/*#__PURE__*/_jsx(Box,{p:4,borderWidth:1,borderRadius:\"lg\",children:/*#__PURE__*/_jsxs(VStack,{spacing:4,align:\"stretch\",children:[/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsx(Text,{mb:2,children:\"Categor\\xEDa\"}),/*#__PURE__*/_jsx(Select,{value:category,onChange:e=>setCategory(e.target.value),children:categories.map(cat=>/*#__PURE__*/_jsx(\"option\",{value:cat,children:cat.charAt(0).toUpperCase()+cat.slice(1)},cat))})]}),/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsxs(Text,{mb:2,children:[\"Rango de Precio ($\",priceRange[0],\" - $\",priceRange[1],\")\"]}),/*#__PURE__*/_jsxs(RangeSlider,{defaultValue:priceRange,min:0,max:2000,step:50,onChange:val=>setPriceRange(val),children:[/*#__PURE__*/_jsx(RangeSliderTrack,{children:/*#__PURE__*/_jsx(RangeSliderFilledTrack,{})}),/*#__PURE__*/_jsx(RangeSliderThumb,{index:0}),/*#__PURE__*/_jsx(RangeSliderThumb,{index:1})]})]}),/*#__PURE__*/_jsx(Checkbox,{isChecked:inStock,onChange:e=>setInStock(e.target.checked),children:\"Solo productos en stock\"}),/*#__PURE__*/_jsx(Button,{colorScheme:\"blue\",onClick:applyFilters,children:\"Aplicar Filtros\"})]})});};","map":{"version":3,"names":["React","useState","Box","VStack","Select","RangeSlider","RangeSliderTrack","RangeSliderFilledTrack","RangeSliderThumb","Text","Checkbox","Button","useToast","jsx","_jsx","jsxs","_jsxs","ProductFilters","_ref","onFilter","category","setCategory","priceRange","setPriceRange","inStock","setInStock","toast","categories","applyFilters","queryParams","URLSearchParams","window","location","search","set","history","pushState","pathname","localStorage","setItem","JSON","stringify","savedCallback","getItem","eval","title","status","duration","isClosable","p","borderWidth","borderRadius","children","spacing","align","mb","value","onChange","e","target","map","cat","charAt","toUpperCase","slice","defaultValue","min","max","step","val","index","isChecked","checked","colorScheme","onClick"],"sources":["/home/ubuntu/cybershop-vuln-lab/CyberShop/frontend/src/components/ProductFilters.js"],"sourcesContent":["import React, { useState } from 'react';\nimport {\n  Box,\n  VStack,\n  Select,\n  RangeSlider,\n  RangeSliderTrack,\n  RangeSliderFilledTrack,\n  RangeSliderThumb,\n  Text,\n  Checkbox,\n  Button,\n  useToast\n} from '@chakra-ui/react';\n\n// Componente vulnerable que permite manipulación de parámetros de filtro\nexport const ProductFilters = ({ onFilter }) => {\n  const [category, setCategory] = useState('all');\n  const [priceRange, setPriceRange] = useState([0, 2000]);\n  const [inStock, setInStock] = useState(false);\n  const toast = useToast();\n\n  const categories = [\n    'all',\n    'laptops',\n    'smartphones',\n    'tablets',\n    'accessories'\n  ];\n\n  // Vulnerable: No validación de entrada en los filtros\n  const applyFilters = () => {\n    // Vulnerable: Inyección de parámetros en la URL\n    const queryParams = new URLSearchParams(window.location.search);\n    queryParams.set('category', category);\n    queryParams.set('minPrice', priceRange[0]);\n    queryParams.set('maxPrice', priceRange[1]);\n    queryParams.set('inStock', inStock);\n\n    // Vulnerable: Actualización directa de la URL sin sanitización\n    window.history.pushState({}, '', `${window.location.pathname}?${queryParams}`);\n\n    // Vulnerable: Almacenamiento de preferencias sin encriptación\n    localStorage.setItem('lastFilter', JSON.stringify({\n      category,\n      priceRange,\n      inStock\n    }));\n\n    // Vulnerable: Ejecución directa de código desde localStorage\n    const savedCallback = localStorage.getItem('filterCallback');\n    if (savedCallback) {\n      eval(savedCallback);\n    }\n\n    onFilter({\n      category,\n      priceRange,\n      inStock\n    });\n\n    toast({\n      title: \"Filtros aplicados\",\n      status: \"success\",\n      duration: 2000,\n      isClosable: true,\n    });\n  };\n\n  return (\n    <Box p={4} borderWidth={1} borderRadius=\"lg\">\n      <VStack spacing={4} align=\"stretch\">\n        <Box>\n          <Text mb={2}>Categoría</Text>\n          <Select\n            value={category}\n            onChange={(e) => setCategory(e.target.value)}\n          >\n            {categories.map((cat) => (\n              <option key={cat} value={cat}>\n                {cat.charAt(0).toUpperCase() + cat.slice(1)}\n              </option>\n            ))}\n          </Select>\n        </Box>\n\n        <Box>\n          <Text mb={2}>Rango de Precio (${priceRange[0]} - ${priceRange[1]})</Text>\n          <RangeSlider\n            defaultValue={priceRange}\n            min={0}\n            max={2000}\n            step={50}\n            onChange={(val) => setPriceRange(val)}\n          >\n            <RangeSliderTrack>\n              <RangeSliderFilledTrack />\n            </RangeSliderTrack>\n            <RangeSliderThumb index={0} />\n            <RangeSliderThumb index={1} />\n          </RangeSlider>\n        </Box>\n\n        <Checkbox\n          isChecked={inStock}\n          onChange={(e) => setInStock(e.target.checked)}\n        >\n          Solo productos en stock\n        </Checkbox>\n\n        <Button colorScheme=\"blue\" onClick={applyFilters}>\n          Aplicar Filtros\n        </Button>\n      </VStack>\n    </Box>\n  );\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}