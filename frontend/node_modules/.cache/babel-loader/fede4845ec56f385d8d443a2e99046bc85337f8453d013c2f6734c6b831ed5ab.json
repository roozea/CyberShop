{"ast":null,"code":"import React,{useState}from'react';import{Box,Text,Button,SimpleGrid,Image,VStack,useToast,IconButton}from'@chakra-ui/react';import{DeleteIcon}from'@chakra-ui/icons';// Componente vulnerable que almacena datos sensibles en localStorage sin encriptación\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export const WishList=()=>{const[wishList,setWishList]=useState(()=>{// Vulnerable: Datos almacenados sin encriptación en localStorage\nconst savedWishList=localStorage.getItem('wishList');return savedWishList?JSON.parse(savedWishList):[{id:1,name:\"Laptop Gaming Pro\",price:1299.99,image:\"https://source.unsplash.com/random/200x200?laptop\"},{id:2,name:\"Smartphone Ultra\",price:899.99,image:\"https://source.unsplash.com/random/200x200?smartphone\"}];});const toast=useToast();// Vulnerable: No validación de datos antes de guardar\nconst removeFromWishList=productId=>{const updatedWishList=wishList.filter(item=>item.id!==productId);setWishList(updatedWishList);// Vulnerable: Almacenamiento directo sin validación\nlocalStorage.setItem('wishList',JSON.stringify(updatedWishList));toast({title:\"Producto eliminado de la lista de deseos\",status:\"success\",duration:3000,isClosable:true});};const addToCart=product=>{// Vulnerable: Inyección de datos directa al carrito\nconst cart=JSON.parse(localStorage.getItem('cart')||'[]');cart.push(product);localStorage.setItem('cart',JSON.stringify(cart));toast({title:\"Producto agregado al carrito\",status:\"success\",duration:3000,isClosable:true});};return/*#__PURE__*/_jsxs(Box,{p:4,children:[/*#__PURE__*/_jsx(Text,{fontSize:\"2xl\",mb:4,children:\"Mi Lista de Deseos\"}),/*#__PURE__*/_jsx(SimpleGrid,{columns:[1,2,3],spacing:4,children:wishList.map(product=>/*#__PURE__*/_jsxs(Box,{borderWidth:1,borderRadius:\"lg\",overflow:\"hidden\",p:4,children:[/*#__PURE__*/_jsx(Image,{src:product.image,alt:product.name,borderRadius:\"md\",mb:4}),/*#__PURE__*/_jsxs(VStack,{align:\"start\",spacing:2,children:[/*#__PURE__*/_jsx(Text,{fontWeight:\"bold\",children:product.name}),/*#__PURE__*/_jsxs(Text,{color:\"blue.600\",children:[\"$\",product.price]}),/*#__PURE__*/_jsx(Button,{colorScheme:\"blue\",size:\"sm\",onClick:()=>addToCart(product),width:\"full\",children:\"Agregar al Carrito\"}),/*#__PURE__*/_jsx(IconButton,{\"aria-label\":\"Eliminar de la lista\",icon:/*#__PURE__*/_jsx(DeleteIcon,{}),onClick:()=>removeFromWishList(product.id),colorScheme:\"red\",size:\"sm\",width:\"full\"})]})]},product.id))})]});};","map":{"version":3,"names":["React","useState","Box","Text","Button","SimpleGrid","Image","VStack","useToast","IconButton","DeleteIcon","jsx","_jsx","jsxs","_jsxs","WishList","wishList","setWishList","savedWishList","localStorage","getItem","JSON","parse","id","name","price","image","toast","removeFromWishList","productId","updatedWishList","filter","item","setItem","stringify","title","status","duration","isClosable","addToCart","product","cart","push","p","children","fontSize","mb","columns","spacing","map","borderWidth","borderRadius","overflow","src","alt","align","fontWeight","color","colorScheme","size","onClick","width","icon"],"sources":["/home/ubuntu/cybershop-vuln-lab/CyberShop/frontend/src/components/WishList.js"],"sourcesContent":["import React, { useState } from 'react';\nimport {\n  Box,\n  Text,\n  Button,\n  SimpleGrid,\n  Image,\n  VStack,\n  useToast,\n  IconButton\n} from '@chakra-ui/react';\nimport { DeleteIcon } from '@chakra-ui/icons';\n\n// Componente vulnerable que almacena datos sensibles en localStorage sin encriptación\nexport const WishList = () => {\n  const [wishList, setWishList] = useState(() => {\n    // Vulnerable: Datos almacenados sin encriptación en localStorage\n    const savedWishList = localStorage.getItem('wishList');\n    return savedWishList ? JSON.parse(savedWishList) : [\n      {\n        id: 1,\n        name: \"Laptop Gaming Pro\",\n        price: 1299.99,\n        image: \"https://source.unsplash.com/random/200x200?laptop\",\n      },\n      {\n        id: 2,\n        name: \"Smartphone Ultra\",\n        price: 899.99,\n        image: \"https://source.unsplash.com/random/200x200?smartphone\",\n      }\n    ];\n  });\n\n  const toast = useToast();\n\n  // Vulnerable: No validación de datos antes de guardar\n  const removeFromWishList = (productId) => {\n    const updatedWishList = wishList.filter(item => item.id !== productId);\n    setWishList(updatedWishList);\n    // Vulnerable: Almacenamiento directo sin validación\n    localStorage.setItem('wishList', JSON.stringify(updatedWishList));\n\n    toast({\n      title: \"Producto eliminado de la lista de deseos\",\n      status: \"success\",\n      duration: 3000,\n      isClosable: true,\n    });\n  };\n\n  const addToCart = (product) => {\n    // Vulnerable: Inyección de datos directa al carrito\n    const cart = JSON.parse(localStorage.getItem('cart') || '[]');\n    cart.push(product);\n    localStorage.setItem('cart', JSON.stringify(cart));\n\n    toast({\n      title: \"Producto agregado al carrito\",\n      status: \"success\",\n      duration: 3000,\n      isClosable: true,\n    });\n  };\n\n  return (\n    <Box p={4}>\n      <Text fontSize=\"2xl\" mb={4}>Mi Lista de Deseos</Text>\n      <SimpleGrid columns={[1, 2, 3]} spacing={4}>\n        {wishList.map((product) => (\n          <Box\n            key={product.id}\n            borderWidth={1}\n            borderRadius=\"lg\"\n            overflow=\"hidden\"\n            p={4}\n          >\n            <Image\n              src={product.image}\n              alt={product.name}\n              borderRadius=\"md\"\n              mb={4}\n            />\n            <VStack align=\"start\" spacing={2}>\n              <Text fontWeight=\"bold\">{product.name}</Text>\n              <Text color=\"blue.600\">${product.price}</Text>\n              <Button\n                colorScheme=\"blue\"\n                size=\"sm\"\n                onClick={() => addToCart(product)}\n                width=\"full\"\n              >\n                Agregar al Carrito\n              </Button>\n              <IconButton\n                aria-label=\"Eliminar de la lista\"\n                icon={<DeleteIcon />}\n                onClick={() => removeFromWishList(product.id)}\n                colorScheme=\"red\"\n                size=\"sm\"\n                width=\"full\"\n              />\n            </VStack>\n          </Box>\n        ))}\n      </SimpleGrid>\n    </Box>\n  );\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}