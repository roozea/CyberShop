{"ast":null,"code":"import{Box,Button,FormControl,FormLabel,Input,VStack,Heading,Text,useToast}from'@chakra-ui/react';import{Link,useNavigate}from'react-router-dom';import{useState}from'react';import{register}from'../services/api';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export const Register=()=>{const toast=useToast();const navigate=useNavigate();const[formData,setFormData]=useState({email:'',password:'',confirmPassword:'',credit_card:'',address:''});const handleChange=e=>{const{name,value}=e.target;setFormData(prev=>({...prev,[name]:value}));};const handleRegister=async e=>{e.preventDefault();// Vulnerable: No validación de contraseña\nif(formData.password!==formData.confirmPassword){toast({title:'Error',description:'Las contraseñas no coinciden',status:'error',duration:3000,isClosable:true});return;}// Vulnerable: Envío de datos sensibles sin encriptar\nconst userData={email:formData.email,password:formData.password,credit_card:formData.credit_card,address:formData.address};const response=await register(userData);if(response){toast({title:'Registro exitoso',description:'Tu cuenta ha sido creada',status:'success',duration:3000,isClosable:true});navigate('/login');}else{toast({title:'Error en el registro',description:'No se pudo crear la cuenta',status:'error',duration:3000,isClosable:true});}};return/*#__PURE__*/_jsx(Box,{maxW:\"md\",mx:\"auto\",mt:8,children:/*#__PURE__*/_jsxs(VStack,{spacing:4,align:\"stretch\",as:\"form\",onSubmit:handleRegister,children:[/*#__PURE__*/_jsx(Heading,{children:\"Registro\"}),/*#__PURE__*/_jsxs(FormControl,{children:[/*#__PURE__*/_jsx(FormLabel,{children:\"Email\"}),/*#__PURE__*/_jsx(Input,{type:\"email\",name:\"email\",value:formData.email,onChange:handleChange,placeholder:\"tu@email.com\"})]}),/*#__PURE__*/_jsxs(FormControl,{children:[/*#__PURE__*/_jsx(FormLabel,{children:\"Contrase\\xF1a\"}),/*#__PURE__*/_jsx(Input,{type:\"password\",name:\"password\",value:formData.password,onChange:handleChange,placeholder:\"********\"})]}),/*#__PURE__*/_jsxs(FormControl,{children:[/*#__PURE__*/_jsx(FormLabel,{children:\"Confirmar Contrase\\xF1a\"}),/*#__PURE__*/_jsx(Input,{type:\"password\",name:\"confirmPassword\",value:formData.confirmPassword,onChange:handleChange,placeholder:\"********\"})]}),/*#__PURE__*/_jsxs(FormControl,{children:[/*#__PURE__*/_jsx(FormLabel,{children:\"Tarjeta de Cr\\xE9dito\"}),/*#__PURE__*/_jsx(Input,{type:\"text\",name:\"credit_card\",value:formData.credit_card,onChange:handleChange,placeholder:\"1234-5678-9012-3456\"})]}),/*#__PURE__*/_jsxs(FormControl,{children:[/*#__PURE__*/_jsx(FormLabel,{children:\"Direcci\\xF3n\"}),/*#__PURE__*/_jsx(Input,{type:\"text\",name:\"address\",value:formData.address,onChange:handleChange,placeholder:\"Tu direcci\\xF3n\"})]}),/*#__PURE__*/_jsx(Button,{type:\"submit\",colorScheme:\"blue\",children:\"Registrarse\"}),/*#__PURE__*/_jsxs(Text,{children:[\"\\xBFYa tienes cuenta? \",/*#__PURE__*/_jsx(Link,{to:\"/login\",style:{color:'blue'},children:\"Ingresa aqu\\xED\"})]})]})});};","map":{"version":3,"names":["Box","Button","FormControl","FormLabel","Input","VStack","Heading","Text","useToast","Link","useNavigate","useState","register","jsx","_jsx","jsxs","_jsxs","Register","toast","navigate","formData","setFormData","email","password","confirmPassword","credit_card","address","handleChange","e","name","value","target","prev","handleRegister","preventDefault","title","description","status","duration","isClosable","userData","response","maxW","mx","mt","children","spacing","align","as","onSubmit","type","onChange","placeholder","colorScheme","to","style","color"],"sources":["/home/ubuntu/cybershop-vuln-lab/CyberShop/frontend/src/pages/Register.js"],"sourcesContent":["import { Box, Button, FormControl, FormLabel, Input, VStack, Heading, Text, useToast } from '@chakra-ui/react';\nimport { Link, useNavigate } from 'react-router-dom';\nimport { useState } from 'react';\nimport { register } from '../services/api';\n\nexport const Register = () => {\n  const toast = useToast();\n  const navigate = useNavigate();\n  const [formData, setFormData] = useState({\n    email: '',\n    password: '',\n    confirmPassword: '',\n    credit_card: '',\n    address: ''\n  });\n\n  const handleChange = (e) => {\n    const { name, value } = e.target;\n    setFormData(prev => ({\n      ...prev,\n      [name]: value\n    }));\n  };\n\n  const handleRegister = async (e) => {\n    e.preventDefault();\n\n    // Vulnerable: No validación de contraseña\n    if (formData.password !== formData.confirmPassword) {\n      toast({\n        title: 'Error',\n        description: 'Las contraseñas no coinciden',\n        status: 'error',\n        duration: 3000,\n        isClosable: true,\n      });\n      return;\n    }\n\n    // Vulnerable: Envío de datos sensibles sin encriptar\n    const userData = {\n      email: formData.email,\n      password: formData.password,\n      credit_card: formData.credit_card,\n      address: formData.address\n    };\n\n    const response = await register(userData);\n\n    if (response) {\n      toast({\n        title: 'Registro exitoso',\n        description: 'Tu cuenta ha sido creada',\n        status: 'success',\n        duration: 3000,\n        isClosable: true,\n      });\n      navigate('/login');\n    } else {\n      toast({\n        title: 'Error en el registro',\n        description: 'No se pudo crear la cuenta',\n        status: 'error',\n        duration: 3000,\n        isClosable: true,\n      });\n    }\n  };\n\n  return (\n    <Box maxW=\"md\" mx=\"auto\" mt={8}>\n      <VStack spacing={4} align=\"stretch\" as=\"form\" onSubmit={handleRegister}>\n        <Heading>Registro</Heading>\n        <FormControl>\n          <FormLabel>Email</FormLabel>\n          <Input\n            type=\"email\"\n            name=\"email\"\n            value={formData.email}\n            onChange={handleChange}\n            placeholder=\"tu@email.com\"\n          />\n        </FormControl>\n        <FormControl>\n          <FormLabel>Contraseña</FormLabel>\n          <Input\n            type=\"password\"\n            name=\"password\"\n            value={formData.password}\n            onChange={handleChange}\n            placeholder=\"********\"\n          />\n        </FormControl>\n        <FormControl>\n          <FormLabel>Confirmar Contraseña</FormLabel>\n          <Input\n            type=\"password\"\n            name=\"confirmPassword\"\n            value={formData.confirmPassword}\n            onChange={handleChange}\n            placeholder=\"********\"\n          />\n        </FormControl>\n        <FormControl>\n          <FormLabel>Tarjeta de Crédito</FormLabel>\n          <Input\n            type=\"text\"\n            name=\"credit_card\"\n            value={formData.credit_card}\n            onChange={handleChange}\n            placeholder=\"1234-5678-9012-3456\"\n          />\n        </FormControl>\n        <FormControl>\n          <FormLabel>Dirección</FormLabel>\n          <Input\n            type=\"text\"\n            name=\"address\"\n            value={formData.address}\n            onChange={handleChange}\n            placeholder=\"Tu dirección\"\n          />\n        </FormControl>\n        <Button type=\"submit\" colorScheme=\"blue\">Registrarse</Button>\n        <Text>\n          ¿Ya tienes cuenta? <Link to=\"/login\" style={{ color: 'blue' }}>Ingresa aquí</Link>\n        </Text>\n      </VStack>\n    </Box>\n  );\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}